---
// Hero Section Component
---

<section class="hero-section relative min-h-screen flex items-center justify-center px-6 py-20 overflow-hidden select-none">
	<!-- Background Grid -->
	<div class="absolute inset-0 bg-[linear-gradient(to_right,#1a1a1a_1px,transparent_1px),linear-gradient(to_bottom,#1a1a1a_1px,transparent_1px)] bg-[size:40px_40px]"></div>

	<!-- Animated Scan Lines -->
	<div class="absolute inset-0 overflow-hidden pointer-events-none">
		<div id="scan-line" class="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-cyan-300 to-transparent animate-scan"></div>
	</div>

	<!-- Content -->
	<div class="relative z-10 max-w-6xl mx-auto text-center">
		<div class="mb-12 animate-fade-in">
			<div class="inline-block px-6 py-3 mb-8 text-xs font-mono tracking-[0.3em] text-cyan-400 bg-black border-2 border-cyan-500 uppercase">
				信于东大 始于初心
			</div>
		</div>

		<h1 class="text-6xl md:text-8xl font-black mb-8 animate-fade-in-up tracking-tighter leading-none">
			<span
				id="hero-title-stack"
				class="hero-title-stack block font-medium text-white is-primary-active"
				aria-label="信使计划 / 小猴偷米"
			>
				<span class="hero-title-placeholder" aria-hidden="true">信使计划</span>
				<span class="hero-title-layer title-primary" aria-hidden="true">信使计划</span>
				<span class="hero-title-layer title-alt" aria-hidden="true">小猴偷米</span>
			</span>
			<span class="text-white block text-4xl md:text-5xl tracking-wide mt-2 font-extralight font-serif">工作室</span>
			<span class="text-cyan-400 block mt-4 font-extralight tracking-wide font-serif">Herald Studio</span>
		</h1>

		<div class="mb-16 animate-fade-in-up delay-200 min-h-[6rem]">
			<div class="text-xl md:text-2xl font-mono mb-2">
				<span class="code-line code-line-1">
					<span class="text-gray-500">&gt;</span> <span class="text-cyan-400">println!</span><span class="text-gray-400">(</span><span class="text-green-400">"用代码改变世界"</span><span class="text-gray-400">);</span>
				</span><span class="cursor cursor-1"></span>
			</div>
			<div class="text-xl md:text-2xl font-mono">
				<span class="code-line code-line-2">
					<span class="text-gray-500">&gt;</span> <span class="text-cyan-400">println!</span><span class="text-gray-400">(</span><span class="text-green-400">"用技术创造未来"</span><span class="text-gray-400">);</span>
				</span><span class="cursor cursor-2"></span>
			</div>
		</div>

		<div class="flex flex-col sm:flex-row gap-6 justify-center animate-fade-in-up delay-400">
			<a href="#join" class="group relative px-10 py-4 bg-cyan-500 text-black font-bold text-lg uppercase tracking-wide overflow-hidden transition-all duration-300">
				<span class="relative z-10">立即加入</span>
				<div class="absolute inset-0 bg-white transform translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
			</a>
			<a href="#about" class="px-10 py-4 bg-transparent text-white font-bold text-lg uppercase tracking-wide border-2 border-white hover:bg-white hover:text-black transition-all duration-300">
				了解更多
			</a>
		</div>
	</div>

	<!-- Corner Decorations -->
	<div class="absolute top-3 left-3 md:top-8 md:left-8 w-12 h-12 md:w-16 md:h-16 border-t-2 border-l-2 border-cyan-500"></div>
	<div class="absolute top-3 right-3 md:top-8 md:right-8 w-12 h-12 md:w-16 md:h-16 border-t-2 border-r-2 border-cyan-500"></div>
	<div class="absolute bottom-3 left-3 md:bottom-8 md:left-8 w-12 h-12 md:w-16 md:h-16 border-b-2 border-l-2 border-cyan-500"></div>
	<div class="absolute bottom-3 right-3 md:bottom-8 md:right-8 w-12 h-12 md:w-16 md:h-16 border-b-2 border-r-2 border-cyan-500"></div>
</section>

<script>
	function setViewportHeight() {
		const height = Math.min(
			window.visualViewport?.height || Infinity,
			window.innerHeight,
			document.documentElement.clientHeight
		);
		document.documentElement.style.setProperty('--safe-vh', `${height}px`);
	}

	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', setViewportHeight);
	} else {
		setViewportHeight();
	}

	setTimeout(setViewportHeight, 100);

	window.addEventListener('resize', setViewportHeight);
	window.addEventListener('orientationchange', () => setTimeout(setViewportHeight, 100));

	if (window.visualViewport) {
		window.visualViewport.addEventListener('resize', setViewportHeight);
	}

	// 平滑滚动处理
	document.querySelectorAll<HTMLAnchorElement>('a[href^="#"]').forEach(anchor => {
		anchor.addEventListener('click', function (e: Event) {
			e.preventDefault();
			const href = anchor.getAttribute('href');
			if (href && href !== '#') {
				const targetId = href.substring(1);
				const targetElement = document.getElementById(targetId);

				if (targetElement) {
					targetElement.scrollIntoView({
						behavior: 'smooth',
						block: 'start'
					});
				}
			}
		});
	});

	(function () {
		const scanEl = document.querySelector('#scan-line');
		const titleStack = document.querySelector('#hero-title-stack');
		if (!scanEl || !titleStack) return;

		let lastTop: number | null = null;
		let mode: 'primary' | 'alt' = (titleStack as HTMLElement).classList.contains('is-alt-active') ? 'alt' : 'primary';

		function applyMode(nextMode: 'primary' | 'alt') {
			if (mode === nextMode) return;
			mode = nextMode;
			(titleStack as HTMLElement).classList.toggle('is-primary-active', mode === 'primary');
			(titleStack as HTMLElement).classList.toggle('is-alt-active', mode === 'alt');
		}

		function toggleMode() {
			applyMode(mode === 'primary' ? 'alt' : 'primary');
		}

		function tick() {
			const scanRect = (scanEl as HTMLElement).getBoundingClientRect();
			const titleRect = (titleStack as HTMLElement).getBoundingClientRect();
			const titleHeight = titleRect.height || 1;

			if (lastTop !== null && scanRect.top + 5 < lastTop) {
				toggleMode();
			}
			lastTop = scanRect.top;

			const lineCenter = scanRect.top + scanRect.height / 2;
			const clampedCenter = Math.min(Math.max(lineCenter, titleRect.top), titleRect.bottom);
			const progress = (clampedCenter - titleRect.top) / titleHeight;
			const clamped = Math.min(1, Math.max(0, progress));

			(titleStack as HTMLElement).style.setProperty('--scan-progress', clamped.toFixed(4));

			requestAnimationFrame(tick);
		}

		requestAnimationFrame(tick);
	})();
</script>

<style>
	.hero-section {
		max-height: var(--safe-vh, 100vh);
	}

	@keyframes scan {
		0% {
			transform: translateY(-100vh);
		}
		100% {
			transform: translateY(100vh);
		}
	}

	.animate-scan {
		animation: scan 3s linear infinite;
	}

	#scan-line {
		opacity: 0.85;
		box-shadow: 0 0 12px rgba(34, 211, 238, 0.8), 0 0 24px rgba(34, 211, 238, 0.45);
		filter: drop-shadow(0 0 6px rgba(45, 212, 191, 0.5));
	}

	@keyframes fade-in {
		from {
			opacity: 0;
		}
		to {
			opacity: 1;
		}
	}

	@keyframes fade-in-up {
		from {
			opacity: 0;
			transform: translateY(30px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.animate-fade-in {
		animation: fade-in 1s ease-out;
	}

	.animate-fade-in-up {
		animation: fade-in-up 1s ease-out;
	}

	.delay-200 {
		animation-delay: 0.2s;
		opacity: 0;
		animation-fill-mode: forwards;
	}

	.delay-400 {
		animation-delay: 0.4s;
		opacity: 0;
		animation-fill-mode: forwards;
	}

	/* 打字机效果 - 总时长7s: 1s延迟 + 2s打第一行 + 2s打第二行 + 2s停留 */
	.code-line {
		display: inline-block;
		overflow: hidden;
		max-width: 0;
		white-space: nowrap;
		vertical-align: bottom;
	}

	.code-line-1 {
		animation: typing-line1 7s steps(25) infinite;
	}

	.code-line-2 {
		animation: typing-line2 7s steps(25) infinite;
	}

	@keyframes typing-line1 {
		0%, 14.28% {
			max-width: 0;
		}
		42.85%, 71.42% {
			max-width: 100%;
		}
		100% {
			max-width: 0;
		}
	}

	@keyframes typing-line2 {
		0%, 42.85% {
			max-width: 0;
		}
		71.42% {
			max-width: 100%;
		}
		100% {
			max-width: 0;
		}
	}

	/* 光标效果 */
	.cursor {
		display: inline-block;
		width: 2px;
		height: 1.5em;
		background-color: cyan;
		margin-left: 2px;
		vertical-align: middle;
	}

	.cursor-1 {
		animation: cursor1-show 7s step-end infinite, blink-cursor 0.7s step-end infinite;
	}

	.cursor-2 {
		animation: cursor2-show 7s step-end infinite, blink-cursor 0.7s step-end infinite;
	}

	@keyframes cursor1-show {
		0%, 14.28% {
			opacity: 1;
		}
		42.85%, 71.42% {
			opacity: 0;
		}
		71.43%, 100% {
			opacity: 1;
		}
	}

	@keyframes cursor2-show {
		0%, 42.84% {
			opacity: 0;
		}
		42.85%, 100% {
			opacity: 1;
		}
	}

	@keyframes blink-cursor {
		50% {
			opacity: 0;
		}
	}

	.hero-title-stack {
		position: relative;
		display: block;
		--scan-progress: 0;
	}

	.hero-title-placeholder {
		visibility: hidden;
		display: block;
	}

	.hero-title-layer {
		position: absolute;
		inset: 0;
		display: block;
		will-change: clip-path;
		transition: none;
	}

	.hero-title-layer.title-primary {
		color: #ffffff;
		font-family: var(--font-serif, 'Noto Serif SC', 'Songti SC', serif);
	}

	.hero-title-layer.title-alt {
    color: #ffffff;
		font-family: var(--font-serif, 'Noto Serif SC', 'Songti SC', serif);
		/* color: #22d3ee; */
		/* font-family: var(--font-sans, 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif); */
	}

	.hero-title-stack.is-primary-active .title-primary {
		z-index: 1;
		clip-path: inset(calc(var(--scan-progress, 0) * 100%) 0 0 0);
	}

	.hero-title-stack.is-primary-active .title-alt {
		z-index: 2;
		clip-path: inset(0 0 calc((1 - var(--scan-progress, 0)) * 100%) 0);
	}

	.hero-title-stack.is-alt-active .title-alt {
		z-index: 1;
		clip-path: inset(calc(var(--scan-progress, 0) * 100%) 0 0 0);
	}

	.hero-title-stack.is-alt-active .title-primary {
		z-index: 2;
		clip-path: inset(0 0 calc((1 - var(--scan-progress, 0)) * 100%) 0);
	}
</style>
